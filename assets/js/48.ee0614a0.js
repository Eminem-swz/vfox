(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{566:function(t,e,v){"use strict";v.r(e);var _=v(49),a=Object(_.a)({},(function(){var t=this,e=t.$createElement,v=t._self._c||e;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"imageuploader-图片上传"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#imageuploader-图片上传"}},[t._v("#")]),t._v(" ImageUploader 图片上传")]),t._v(" "),v("ul",[v("li",[t._v("类似于微信朋友圈上传图片的组件。")]),t._v(" "),v("li",[t._v("可以配合 "),v("RouterLink",{attrs:{to:"/components/Form.html"}},[t._v("Form")]),t._v(" 和 "),v("RouterLink",{attrs:{to:"/components/Form.html#formitem-表单项"}},[t._v("FormItem")]),t._v(" 使用。")],1)]),t._v(" "),v("h2",{attrs:{id:"props"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#props"}},[t._v("#")]),t._v(" Props")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("属性")]),t._v(" "),v("th",[t._v("类型")]),t._v(" "),v("th",[t._v("默认值")]),t._v(" "),v("th",[t._v("必填")]),t._v(" "),v("th",[t._v("说明")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("v-model")]),t._v(" "),v("td",[t._v("string[]")]),t._v(" "),v("td"),t._v(" "),v("td",[t._v("是")]),t._v(" "),v("td",[t._v("已上传的图片 URL 列表")])]),t._v(" "),v("tr",[v("td",[t._v("accept")]),t._v(" "),v("td",[t._v("string")]),t._v(" "),v("td"),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("默认 'all', 可选 'jpg' 'jpeg' 'png' 'webp'，目前移动端图片类型不多，限制比较死")])]),t._v(" "),v("tr",[v("td",[t._v("column-number")]),t._v(" "),v("td",[t._v("number")]),t._v(" "),v("td",[t._v("3")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("渲染列数，同 "),v("RouterLink",{attrs:{to:"/components/Order.html"}},[t._v("Order")]),t._v(" 组件")],1)]),t._v(" "),v("tr",[v("td",[t._v("max-count")]),t._v(" "),v("td",[t._v("number")]),t._v(" "),v("td",[t._v("9")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("文件上传数量限制，上传中/上传失败也会占一个坑位")])]),t._v(" "),v("tr",[v("td",[t._v("preview")]),t._v(" "),v("td",[t._v("boolean")]),t._v(" "),v("td",[t._v("true")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("是否在点击缩略图后展示全屏图片预览")])]),t._v(" "),v("tr",[v("td",[t._v("disabled")]),t._v(" "),v("td",[t._v("boolean")]),t._v(" "),v("td",[t._v("false")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("是否禁用文件上传")])]),t._v(" "),v("tr",[v("td",[t._v("multiple")]),t._v(" "),v("td",[t._v("boolean")]),t._v(" "),v("td",[t._v("false")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("是否开启图片多选，部分安卓机型不支持")])]),t._v(" "),v("tr",[v("td",[t._v("deletable")]),t._v(" "),v("td",[t._v("boolean")]),t._v(" "),v("td",[t._v("true")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("是否允许删除图片")])]),t._v(" "),v("tr",[v("td",[t._v("image-mode")]),t._v(" "),v("td",[t._v("string")]),t._v(" "),v("td",[t._v("'aspectFill'")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("图片的填充模式，通 "),v("RouterLink",{attrs:{to:"/components/Image.html"}},[t._v("Image")]),t._v(" 组件的 mode 属性")],1)]),t._v(" "),v("tr",[v("td",[t._v("before-upload")]),t._v(" "),v("td",[t._v("Function")]),t._v(" "),v("td"),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("文件读取前的回调函数，返回 false 或 Promise"),v("false",[t._v(" 可终止文件上传")])],1)]),t._v(" "),v("tr",[v("td",[t._v("upload-ready")]),t._v(" "),v("td",[t._v("Function")]),t._v(" "),v("td"),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("转入上传文件操作的回调函数")])])])]),t._v(" "),v("h3",{attrs:{id:"beforeupload-file-file-handlers-object-boolean-file-promise-boolean-file"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#beforeupload-file-file-handlers-object-boolean-file-promise-boolean-file"}},[t._v("#")]),t._v(" beforeUpload(file: File, handlers: Object) => boolean | file | Promise<boolean | file>")]),t._v(" "),v("p",[t._v("通过传入 beforeUpload 函数可以在上传前进行校验和处理，返回 false 或 Promise"),v("false",[t._v(" 表示校验失败。")])],1),t._v(" "),v("p",[t._v("也可以返回修改过的 file 对象，如果压缩图片等。")]),t._v(" "),v("h4",{attrs:{id:"beforeupload-的-handlers-提供的方法"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#beforeupload-的-handlers-提供的方法"}},[t._v("#")]),t._v(" beforeUpload 的 handlers 提供的方法")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("handlers 方法")]),t._v(" "),v("th",[t._v("参数返回")]),t._v(" "),v("th",[t._v("说明")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("handlers.formatSize")]),t._v(" "),v("td",[t._v("(size: number) => string")]),t._v(" "),v("td",[t._v("把图片的文件大小数值转为可读的，如 10MB, 10.5KB")])])])]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v('<fx-image-uploader :beforeUpload="onBeforeUpload" />\n')])])]),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("export default {\n  methods: {\n    onBeforeUpload(file, { formatSize }) {\n      if (file.size > 1024 * 1024) {\n        Toast.showToast(`上传图片不能大于 ${formatSize(1024 * 1024)}`)\n        return false\n      }\n      Toast.showToast(`上传图片大小为 ${formatSize(file.size)}`)\n    }\n  }\n}\n")])])]),v("h3",{attrs:{id:"uploadready-file-file-handlers-object-void"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#uploadready-file-file-handlers-object-void"}},[t._v("#")]),t._v(" uploadReady(file: File, handlers: Object) => void")]),t._v(" "),v("p",[t._v("在该节点中将文件上传至服务器。")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("handlers 方法")]),t._v(" "),v("th",[t._v("参数返回")]),t._v(" "),v("th",[t._v("说明")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("handlers.getUploadId")]),t._v(" "),v("td",[t._v("() => number")]),t._v(" "),v("td",[t._v("获取图片上传分配的唯一值")])]),t._v(" "),v("tr",[v("td",[t._v("handlers.formatSize")]),t._v(" "),v("td",[t._v("(size: number) => string")]),t._v(" "),v("td",[t._v("把图片的文件大小数值转为可读的，如 10MB, 10.5KB")])]),t._v(" "),v("tr",[v("td",[t._v("handlers.setUploading")]),t._v(" "),v("td",[t._v("(message: string) => void")]),t._v(" "),v("td",[t._v("设置图片上传状态为上传中")])]),t._v(" "),v("tr",[v("td",[t._v("handlers.success")]),t._v(" "),v("td",[t._v("(url: string) => void")]),t._v(" "),v("td",[t._v("设置图片上传状态为上传成功，传入接口返回的 URL")])]),t._v(" "),v("tr",[v("td",[t._v("handlers.fail")]),t._v(" "),v("td",[t._v("(e: Error | string ) => void")]),t._v(" "),v("td",[t._v("设置图片上传状态为上传失败，传入错误信息")])])])]),t._v(" "),v("p",[t._v("PS：整个上传流程分为 3 个阶段：reading -> uploading -> uploaded | failed，handlers 提供的改变状态方法是不可逆的。")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v('<fx-image-uploader :uploadReady="onUpload" />\n')])])]),v("div",{staticClass:"language- extra-class"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("export default {\n  methods: {\n    onUpload(file, handlers) {\n      handlers.setUploading('上传中...')\n\n      setTimeout(() => {\n        customGetFileUrl(file).then(url => {\n          if (Math.random() > 0.5) {\n            handlers.fail('模拟失败')\n          } else {\n            handlers.success(url)\n          }\n        })\n      }, 2000)\n    }\n  }\n}\n")])])]),v("h2",{attrs:{id:"events"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#events"}},[t._v("#")]),t._v(" Events")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("事件")]),t._v(" "),v("th",[t._v("描述")]),t._v(" "),v("th",[t._v("回调函数参数")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("delete")]),t._v(" "),v("td",[t._v("图片被删除时触发")]),t._v(" "),v("td",[t._v("{ index: number, item: { id: number, status: string, url: string } }")])]),t._v(" "),v("tr",[v("td",[t._v("change")]),t._v(" "),v("td",[t._v("已上传的图片 URL 列表改变时")]),t._v(" "),v("td",[t._v("{ value: string[] }")])])])]),t._v(" "),v("h3",{attrs:{id:"delete-的回调参数-item"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#delete-的回调参数-item"}},[t._v("#")]),t._v(" delete 的回调参数 item")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("值")]),t._v(" "),v("th",[t._v("类型")]),t._v(" "),v("th",[t._v("说明")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("id")]),t._v(" "),v("td",[t._v("number")]),t._v(" "),v("td",[t._v("图片上传项分配的唯一值")])]),t._v(" "),v("tr",[v("td",[t._v("status")]),t._v(" "),v("td",[t._v("string")]),t._v(" "),v("td",[t._v("reading(uploadReady 后)，uploading，uploaded，failed")])]),t._v(" "),v("tr",[v("td",[t._v("url")]),t._v(" "),v("td",[t._v("string")]),t._v(" "),v("td",[t._v("图片 URL 地址")])])])])])}),[],!1,null,null,null);e.default=a.exports}}]);